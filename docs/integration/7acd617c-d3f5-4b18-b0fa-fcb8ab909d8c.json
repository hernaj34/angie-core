{
    "id": "7acd617c-d3f5-4b18-b0fa-fcb8ab909d8c",
    "name": "hl7_visual",
    "data": {
        "id": "7acd617c-d3f5-4b18-b0fa-fcb8ab909d8c",
        "name": "hl7_visual",
        "description": "HL7 visual",
        "created_on": "2021-11-22T10:14:03.257Z",
        "channels": [
            {
                "name": "Channel",
                "id": "fa46d407-40c4-4d69-bc12-2fe5fb861a80",
                "created_on": "2021-11-22T10:15:36.245Z",
                "version": 93,
                "nodes": [
                    {
                        "id": "43fddbee-f513-430a-aa11-345938282e75",
                        "type_id": "331a8e65-ed4e-4911-89b3-20f256870301",
                        "custom_name": "HTTP Input",
                        "links": [
                            {
                                "node_id": "74e596ba-100d-4741-b6c9-9e1a0c5171fc",
                                "handle": null
                            }
                        ],
                        "position": {
                            "x": 123,
                            "y": 105
                        },
                        "data": {
                            "protocol": "jetty:http",
                            "hostname": "0.0.0.0",
                            "path": "/hl7",
                            "port": 8888
                        }
                    },
                    {
                        "id": "74e596ba-100d-4741-b6c9-9e1a0c5171fc",
                        "type_id": "b30ed503-44f3-4387-af08-b7cd2df81f5e",
                        "custom_name": "Visual Groovy Code",
                        "links": [
                            {
                                "node_id": "eeb67b76-4949-4c5e-bb2a-f7fa60180704",
                                "handle": null
                            }
                        ],
                        "position": {
                            "x": 372,
                            "y": 105
                        },
                        "data": {
                            "script": {
                                "contextCode": "camel_context_groovy",
                                "contextMember": {
                                    "memberType": "context",
                                    "code": "context",
                                    "name": "context",
                                    "type": {
                                        "type": "object",
                                        "objectCode": "camel.context"
                                    }
                                },
                                "language": "groovy",
                                "mainStatement": {
                                    "id": "main-block",
                                    "type": "block",
                                    "main": true,
                                    "variables": {
                                        "hl7": {
                                            "memberType": "variable",
                                            "code": "hl7",
                                            "name": "Hl7 Message",
                                            "type": {
                                                "type": "object",
                                                "objectCode": "hl7.v2_5.messages.ORU_R01"
                                            }
                                        },
                                        "index": {
                                            "memberType": "variable",
                                            "code": "index",
                                            "name": "Index",
                                            "type": {
                                                "type": "integer"
                                            }
                                        },
                                        "obj": {
                                            "memberType": "variable",
                                            "code": "obj",
                                            "name": "Object",
                                            "type": {
                                                "type": "object",
                                                "objectCode": "genetic_object"
                                            }
                                        },
                                        "name": {
                                            "memberType": "variable",
                                            "code": "name",
                                            "name": "Nombre",
                                            "type": {
                                                "type": "string"
                                            }
                                        },
                                        "obj2": {
                                            "memberType": "variable",
                                            "code": "obj2",
                                            "name": "Object 2",
                                            "type": {
                                                "type": "object",
                                                "objectCode": "genetic_object"
                                            }
                                        }
                                    },
                                    "nestedStatements": [
                                        {
                                            "variables": [
                                                {
                                                    "type": {
                                                        "type": "object",
                                                        "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                    },
                                                    "code": "hl7",
                                                    "name": "Hl7 Message"
                                                },
                                                {
                                                    "type": {
                                                        "type": "integer"
                                                    },
                                                    "code": "index",
                                                    "name": "Index"
                                                },
                                                {
                                                    "type": {
                                                        "type": "object",
                                                        "objectCode": "genetic_object"
                                                    },
                                                    "code": "obj",
                                                    "name": "Object"
                                                },
                                                {
                                                    "type": {
                                                        "type": "string"
                                                    },
                                                    "code": "name",
                                                    "name": "Nombre"
                                                },
                                                {
                                                    "type": {
                                                        "type": "object",
                                                        "objectCode": "genetic_object"
                                                    },
                                                    "code": "obj2",
                                                    "name": "Object 2"
                                                }
                                            ],
                                            "id": "start",
                                            "type": "start",
                                            "name": "Inicio"
                                        },
                                        {
                                            "id": "5a006c07-d8c4-4de1-b1b7-68c3d0e23d3f",
                                            "type": "expressionGroup",
                                            "name": "Inicialización del mensaje",
                                            "expressions": [
                                                [
                                                    {
                                                        "memberType": "context",
                                                        "code": "context",
                                                        "name": "context",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.context"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variableContainer",
                                                        "code": "variables",
                                                        "name": "Variables",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "variables"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variable",
                                                        "code": "hl7",
                                                        "name": "Hl7 Message",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "method",
                                                        "id": 23758,
                                                        "code": "hl7.oru.newMessage.setter",
                                                        "name": "New message",
                                                        "type": {
                                                            "type": "void"
                                                        },
                                                        "isActive": true,
                                                        "language": "groovy",
                                                        "parentType": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        },
                                                        "sourceCode": "ORU_R01 message = new ORU_R01();\nmessage.initQuickstart(\"ORU\", \"R01\", \"T\");\nnestedSet(context.variables, variablePath, message);",
                                                        "description": "",
                                                        "renderTemplate": "Nuevo mensaje",
                                                        "complexityLevel": 1,
                                                        "sourceCodeForBinaryOperator": "",
                                                        "paramMembers": []
                                                    }
                                                ],
                                                [
                                                    {
                                                        "memberType": "context",
                                                        "code": "context",
                                                        "name": "context",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.context"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variableContainer",
                                                        "code": "variables",
                                                        "name": "Variables",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "variables"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variable",
                                                        "code": "hl7",
                                                        "name": "Hl7 Message",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "method",
                                                        "code": "hl7.oru.terserSet",
                                                        "name": "Terser set",
                                                        "type": {
                                                            "type": "void"
                                                        },
                                                        "isActive": true,
                                                        "language": "groovy",
                                                        "parentType": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        },
                                                        "sourceCode": "Terser terser = new Terser(self);\n\nterserHelper.setData(params.path,params.value);",
                                                        "description": "",
                                                        "paramMembers": [
                                                            {
                                                                "code": "path",
                                                                "name": "Path",
                                                                "type": {
                                                                    "type": "string"
                                                                },
                                                                "required": false
                                                            },
                                                            {
                                                                "code": "value",
                                                                "name": "Valor",
                                                                "type": {
                                                                    "type": "string"
                                                                },
                                                                "required": false
                                                            }
                                                        ],
                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                        "complexityLevel": 1,
                                                        "sourceCodeForBinaryOperator": "",
                                                        "params": {
                                                            "path": "/.MSH-3-1",
                                                            "value": "HIS"
                                                        }
                                                    }
                                                ],
                                                [
                                                    {
                                                        "memberType": "context",
                                                        "code": "context",
                                                        "name": "context",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.context"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variableContainer",
                                                        "code": "variables",
                                                        "name": "Variables",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "variables"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variable",
                                                        "code": "hl7",
                                                        "name": "Hl7 Message",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "method",
                                                        "id": 23760,
                                                        "code": "hl7.oru.terserSet",
                                                        "name": "Terser set",
                                                        "type": {
                                                            "type": "void"
                                                        },
                                                        "isActive": true,
                                                        "language": "groovy",
                                                        "parentType": {
                                                            "type": "object",
                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                        },
                                                        "sourceCode": "Terser terser = new Terser(self);\n\nterser.set(params.path,params.value);",
                                                        "description": "",
                                                        "paramMembers": [
                                                            {
                                                                "code": "path",
                                                                "name": "Path",
                                                                "type": {
                                                                    "type": "string"
                                                                },
                                                                "required": false
                                                            },
                                                            {
                                                                "code": "value",
                                                                "name": "Valor",
                                                                "type": {
                                                                    "type": "string"
                                                                },
                                                                "required": false
                                                            }
                                                        ],
                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                        "complexityLevel": 1,
                                                        "sourceCodeForBinaryOperator": "",
                                                        "params": {
                                                            "path": "/.PID-11(0)-1",
                                                            "value": "Oxford road"
                                                        }
                                                    }
                                                ],
                                                [
                                                    {
                                                        "memberType": "context",
                                                        "code": "context",
                                                        "name": "context",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.context"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variableContainer",
                                                        "code": "variables",
                                                        "name": "Variables",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "variables"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "variable",
                                                        "code": "obj",
                                                        "name": "Object",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "genetic_object"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "method",
                                                        "id": 23763,
                                                        "code": "groovy.core.functions.setJson.setter",
                                                        "name": "Asignar JSON",
                                                        "type": {
                                                            "type": "void",
                                                            "objectCode": "genetic_object"
                                                        },
                                                        "imports": [
                                                            "groovy.json.JsonSlurper"
                                                        ],
                                                        "isActive": true,
                                                        "language": "groovy",
                                                        "parentType": {
                                                            "type": "$any",
                                                            "objectCode": "functions"
                                                        },
                                                        "sourceCode": "params.json = resolveTemplate(params.json, context);\ndef value = new groovy.json.JsonSlurper().parseText(params.json);\nnestedSet(context.variables, variablePath, value);\n",
                                                        "description": "",
                                                        "paramMembers": [
                                                            {
                                                                "code": "json",
                                                                "name": "JSON template",
                                                                "type": {
                                                                    "type": "string",
                                                                    "widget": "AceEditorWidget"
                                                                },
                                                                "options": [
                                                                    {
                                                                        "code": "mode",
                                                                        "value": "json_text"
                                                                    }
                                                                ],
                                                                "required": false
                                                            }
                                                        ],
                                                        "renderTemplate": "JSON {{json}} ",
                                                        "complexityLevel": 1,
                                                        "sourceCodeForBinaryOperator": "",
                                                        "params": {
                                                            "json": "{\n    \"name\": \"Jordi\",\n    \"age\": 46\n}"
                                                        }
                                                    }
                                                ]
                                            ]
                                        },
                                        {
                                            "id": "6e53f85c-1898-4eca-8288-70d14840ca30",
                                            "type": "loop",
                                            "name": "Recorrer n elementos",
                                            "arrayExpression": [
                                                {
                                                    "memberType": "context",
                                                    "code": "context",
                                                    "name": "context",
                                                    "type": {
                                                        "type": "object",
                                                        "objectCode": "camel.context"
                                                    }
                                                },
                                                {
                                                    "memberType": "property",
                                                    "code": "functions",
                                                    "name": "Funciones",
                                                    "type": {
                                                        "type": "object",
                                                        "objectCode": "functions"
                                                    },
                                                    "complexityLevel": 1
                                                },
                                                {
                                                    "memberType": "method",
                                                    "id": 125,
                                                    "code": "groovy.core.functions.range",
                                                    "name": "Nuevo rango de números",
                                                    "type": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "isActive": true,
                                                    "language": "groovy",
                                                    "parentType": {
                                                        "type": "object",
                                                        "objectCode": "functions"
                                                    },
                                                    "sourceCode": "if (params.fromOne){\n    return (1..(params.size)).toList();\n}else{\n    return (0..(params.size-1)).toList();\n}",
                                                    "description": "",
                                                    "paramMembers": [
                                                        {
                                                            "code": "size",
                                                            "name": "Tamaño",
                                                            "type": {
                                                                "type": "integer"
                                                            },
                                                            "required": false
                                                        },
                                                        {
                                                            "code": "fromOne",
                                                            "name": "Primer valor 1",
                                                            "type": {
                                                                "type": "boolean"
                                                            },
                                                            "required": false
                                                        }
                                                    ],
                                                    "renderTemplate": "Lista de {{size}} elementos",
                                                    "complexityLevel": 1,
                                                    "sourceCodeForBinaryOperator": "",
                                                    "params": {
                                                        "size": 3,
                                                        "fromOne": true
                                                    }
                                                }
                                            ],
                                            "itemVariable": "i",
                                            "nestedStatements": [
                                                {
                                                    "id": "2860e745-5cd3-492c-be30-87a7ffc3d966",
                                                    "type": "block",
                                                    "nestedStatements": [
                                                        {
                                                            "id": "e55a2106-968b-4c5a-a647-ab606e18fed5",
                                                            "type": "expressionGroup",
                                                            "name": "Actualizar observación",
                                                            "expressions": [
                                                                [
                                                                    {
                                                                        "memberType": "context",
                                                                        "code": "context",
                                                                        "name": "context",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "camel.context"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variableContainer",
                                                                        "code": "variables",
                                                                        "name": "Variables",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "variables"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variable",
                                                                        "code": "hl7",
                                                                        "name": "Hl7 Message",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "method",
                                                                        "id": 23760,
                                                                        "code": "hl7.oru.terserSet",
                                                                        "name": "Terser set",
                                                                        "type": {
                                                                            "type": "void"
                                                                        },
                                                                        "imports": [
                                                                            "ca.uhn.hl7v2.util.Terser"
                                                                        ],
                                                                        "isActive": true,
                                                                        "language": "groovy",
                                                                        "parentType": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        },
                                                                        "sourceCode": "Terser terser = new Terser(self);\nparams.path = resolveTemplate(params.path, context);\nterser.set(params.path,params.value);",
                                                                        "description": "",
                                                                        "paramMembers": [
                                                                            {
                                                                                "code": "path",
                                                                                "name": "Path",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            },
                                                                            {
                                                                                "code": "value",
                                                                                "name": "Valor",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            }
                                                                        ],
                                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                                        "complexityLevel": 1,
                                                                        "sourceCodeForBinaryOperator": "",
                                                                        "params": {
                                                                            "path": "/.OBSERVATION(#{variables.i})/.OBX-1",
                                                                            "value": "#{variables.i}"
                                                                        }
                                                                    }
                                                                ],
                                                                [
                                                                    {
                                                                        "memberType": "context",
                                                                        "code": "context",
                                                                        "name": "context",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "camel.context"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variableContainer",
                                                                        "code": "variables",
                                                                        "name": "Variables",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "variables"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variable",
                                                                        "code": "hl7",
                                                                        "name": "Hl7 Message",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "method",
                                                                        "id": 23760,
                                                                        "code": "hl7.oru.terserSet",
                                                                        "name": "Terser set",
                                                                        "type": {
                                                                            "type": "void"
                                                                        },
                                                                        "imports": [
                                                                            "ca.uhn.hl7v2.util.Terser"
                                                                        ],
                                                                        "isActive": true,
                                                                        "language": "groovy",
                                                                        "parentType": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        },
                                                                        "sourceCode": "Terser terser = new Terser(self);\nparams.path = resolveTemplate(params.path, context);\nparams.value = resolveTemplate(params.value, context);\nterser.set(params.path,params.value);",
                                                                        "description": "",
                                                                        "paramMembers": [
                                                                            {
                                                                                "code": "path",
                                                                                "name": "Path",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            },
                                                                            {
                                                                                "code": "value",
                                                                                "name": "Valor",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            }
                                                                        ],
                                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                                        "complexityLevel": 1,
                                                                        "sourceCodeForBinaryOperator": "",
                                                                        "params": {
                                                                            "path": "/.OBSERVATION(#{variables.i})/.OBX-2",
                                                                            "value": "#{variables.obj.name}"
                                                                        }
                                                                    }
                                                                ],
                                                                [
                                                                    {
                                                                        "memberType": "context",
                                                                        "code": "context",
                                                                        "name": "context",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "camel.context"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variableContainer",
                                                                        "code": "variables",
                                                                        "name": "Variables",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "variables"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variable",
                                                                        "code": "hl7",
                                                                        "name": "Hl7 Message",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "method",
                                                                        "id": 23760,
                                                                        "code": "hl7.oru.terserSet",
                                                                        "name": "Terser set",
                                                                        "type": {
                                                                            "type": "void"
                                                                        },
                                                                        "isActive": true,
                                                                        "language": "groovy",
                                                                        "parentType": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        },
                                                                        "sourceCode": "Terser terser = new Terser(self);\n\nterser.set(params.path,params.value);",
                                                                        "description": "",
                                                                        "paramMembers": [
                                                                            {
                                                                                "code": "path",
                                                                                "name": "Path",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            },
                                                                            {
                                                                                "code": "value",
                                                                                "name": "Valor",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            }
                                                                        ],
                                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                                        "complexityLevel": 1,
                                                                        "sourceCodeForBinaryOperator": "",
                                                                        "params": {
                                                                            "path": "/.OBSERVATION(#{variables.i})/.OBX-3-1",
                                                                            "value": "Valor de campo #{variables.i}"
                                                                        }
                                                                    }
                                                                ],
                                                                [
                                                                    {
                                                                        "memberType": "context",
                                                                        "code": "context",
                                                                        "name": "context",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "camel.context"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variableContainer",
                                                                        "code": "variables",
                                                                        "name": "Variables",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "variables"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variable",
                                                                        "code": "hl7",
                                                                        "name": "Hl7 Message",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "method",
                                                                        "id": 23760,
                                                                        "code": "hl7.oru.terserSet",
                                                                        "name": "Terser set",
                                                                        "type": {
                                                                            "type": "void"
                                                                        },
                                                                        "isActive": true,
                                                                        "language": "groovy",
                                                                        "parentType": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        },
                                                                        "sourceCode": "Terser terser = new Terser(self);\n\nterser.set(params.path,params.value);",
                                                                        "description": "",
                                                                        "paramMembers": [
                                                                            {
                                                                                "code": "path",
                                                                                "name": "Path",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            },
                                                                            {
                                                                                "code": "value",
                                                                                "name": "Valor",
                                                                                "type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "required": false
                                                                            }
                                                                        ],
                                                                        "renderTemplate": "Terser set {{path}} with {{value}}",
                                                                        "complexityLevel": 1,
                                                                        "sourceCodeForBinaryOperator": "",
                                                                        "params": {
                                                                            "path": "/.OBSERVATION(#{variables.i})/.OBX-5",
                                                                            "value": "Zapato 3"
                                                                        }
                                                                    }
                                                                ]
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "id": "222ad64a-8fd9-4d7b-a93f-21c1504cae98",
                                            "type": "expressionGroup",
                                            "name": "Codificar mensaje",
                                            "expressions": [
                                                [
                                                    {
                                                        "memberType": "context",
                                                        "code": "context",
                                                        "name": "context",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.context"
                                                        }
                                                    },
                                                    {
                                                        "memberType": "property",
                                                        "code": "exchange",
                                                        "name": "Exchange",
                                                        "type": {
                                                            "type": "object",
                                                            "objectCode": "camel.exchange"
                                                        },
                                                        "complexityLevel": 1
                                                    },
                                                    {
                                                        "memberType": "method",
                                                        "id": 22457,
                                                        "code": "camel.exchange.setBody",
                                                        "name": "Set body",
                                                        "type": {
                                                            "type": "void"
                                                        },
                                                        "name_": "Test CLONED",
                                                        "isActive": true,
                                                        "language": "groovy",
                                                        "parentType": {
                                                            "type": "object",
                                                            "objectCode": "camel.exchange"
                                                        },
                                                        "sourceCode": "self.getIn().setBody(params.body);",
                                                        "description": "",
                                                        "paramMembers": [
                                                            {
                                                                "code": "body",
                                                                "name": "Cuerpo",
                                                                "type": {
                                                                    "type": "string"
                                                                },
                                                                "required": false
                                                            }
                                                        ],
                                                        "renderTemplate": "Modificar cuerpo {{body}}",
                                                        "complexityLevel": 1,
                                                        "sourceCodeForBinaryOperator": "",
                                                        "params": {
                                                            "body": {
                                                                "$exp": [
                                                                    {
                                                                        "memberType": "context",
                                                                        "code": "context",
                                                                        "name": "context",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "camel.context"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variableContainer",
                                                                        "code": "variables",
                                                                        "name": "Variables",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "variables"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "variable",
                                                                        "code": "hl7",
                                                                        "name": "Hl7 Message",
                                                                        "type": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        }
                                                                    },
                                                                    {
                                                                        "memberType": "method",
                                                                        "code": "hl7.oru.encode",
                                                                        "name": "Codificar",
                                                                        "type": {
                                                                            "type": "string"
                                                                        },
                                                                        "isActive": true,
                                                                        "language": "groovy",
                                                                        "parentType": {
                                                                            "type": "object",
                                                                            "objectCode": "hl7.v2_5.messages.ORU_R01"
                                                                        },
                                                                        "sourceCode": "return self.encode();",
                                                                        "description": "",
                                                                        "renderTemplate": "Codificar",
                                                                        "complexityLevel": 1,
                                                                        "sourceCodeForBinaryOperator": "",
                                                                        "paramMembers": []
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                ]
                                            ]
                                        },
                                        {
                                            "id": "end",
                                            "type": "end",
                                            "name": "Fin de programa"
                                        }
                                    ]
                                }
                            },
                            "label": "Visual Groovy Code",
                            "beforeSave": "generateCode",
                            "code": "import com.github.mustachejava.DefaultMustacheFactory;\nimport com.github.mustachejava.Mustache;\nimport java.io.StringReader;\nimport java.io.StringWriter;\nimport java.io.Writer;\nimport ca.uhn.hl7v2.model.v25.message.ORU_R01;\nimport ca.uhn.hl7v2.util.Terser;\nimport groovy.json.JsonSlurper;\n\n// Code preparation\ndef context = [exchange: exchange, request: request, response: response, properties: properties, variables: [:]];\ndef nestedSet( variables, variablePath, Object value){\n    def index = 0\n    def currentVariable = variables\n    for (member in variablePath){\n        if (index == variablePath.size() - 1) {\n            currentVariable[member] = value\n        }else{\n            if (!currentVariable.containsKey(member)){\n                currentVariable[member] = [:]\n            }\n            currentVariable = currentVariable[member]\n        }\n        index++\n    }\n}\n\ndef resolveTemplate(String template, Object context){\n    Writer writer = new StringWriter();\n    DefaultMustacheFactory mf = new DefaultMustacheFactory();\n    mf.compile(new StringReader(template),\"test\",\"#{\",\"}\").execute(writer,context);\n    return writer.toString();\n}\n\n// Functions\n\ndef setter(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    ORU_R01 message = new ORU_R01();\n    message.initQuickstart(\"ORU\", \"R01\", \"T\");\n    nestedSet(context.variables, variablePath, message);\n}\n\ndef terserSet(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    Terser terser = new Terser(self);\n    params.path = resolveTemplate(params.path, context);\n    params.value = resolveTemplate(params.value, context);\n    terser.set(params.path,params.value);\n}\n\ndef setter_1(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    params.json = resolveTemplate(params.json, context);\n    def value = new groovy.json.JsonSlurper().parseText(params.json);\n    nestedSet(context.variables, variablePath, value);\n    \n}\n\ndef range(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    if (params.fromOne){\n        return (1..(params.size)).toList();\n    }else{\n        return (0..(params.size-1)).toList();\n    }\n}\n\ndef setBody(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    self.getIn().setBody(params.body);\n}\n\ndef encode(self, options) {\n    context = options.context;\n    params = options.params;\n    variablePath = options.variablePath;\n    return self.encode();\n}\n\n// Start\n\n// Inicialización del mensaje\nsetter(context?.variables?.hl7, [ params: [:], variablePath: [\"hl7\"], context: context]);\nterserSet(context?.variables?.hl7, [ params: [\"path\": \"/.MSH-3-1\", \"value\": \"HIS\"], variablePath: [\"hl7\"], context: context]);\nterserSet(context?.variables?.hl7, [ params: [\"path\": \"/.PID-11(0)-1\", \"value\": \"Oxford road\"], variablePath: [\"hl7\"], context: context]);\nsetter_1(context?.variables?.obj, [ params: [\"json\": \"{\\n    \\\"name\\\": \\\"Jordi\\\",\\n    \\\"age\\\": 46\\n}\"], variablePath: [\"obj\"], context: context]);\n\n// Recorrer n elementos\ncontext.variables['iIndex'] =  0;\nfor (i in range(context?.functions, [ params: [\"size\": 3, \"fromOne\": true], context: context])) {\n    context.variables['i'] =  i;\n    \n    // Actualizar observación\n    terserSet(context?.variables?.hl7, [ params: [\"path\": \"/.OBSERVATION(#{variables.i})/.OBX-1\", \"value\": \"#{variables.i}\"], variablePath: [\"hl7\"], context: context]);\n    terserSet(context?.variables?.hl7, [ params: [\"path\": \"/.OBSERVATION(#{variables.i})/.OBX-2\", \"value\": \"#{variables.obj.name}\"], variablePath: [\"hl7\"], context: context]);\n    terserSet(context?.variables?.hl7, [ params: [\"path\": \"/.OBSERVATION(#{variables.i})/.OBX-3-1\", \"value\": \"Valor de campo #{variables.i}\"], variablePath: [\"hl7\"], context: context]);\n    terserSet(context?.variables?.hl7, [ params: [\"path\": \"/.OBSERVATION(#{variables.i})/.OBX-5\", \"value\": \"Zapato 3\"], variablePath: [\"hl7\"], context: context]);\ncontext.variables['iIndex'] +=  1;\n}\n\n// Codificar mensaje\nsetBody(context?.exchange, [ params: [\"body\": encode(context?.variables?.hl7, [ params: [:], variablePath: [\"hl7\"], context: context])], context: context]);\n\n// End"
                        }
                    },
                    {
                        "id": "eeb67b76-4949-4c5e-bb2a-f7fa60180704",
                        "type_id": "e0a4f9f7-0d4b-4fd4-a500-dc944b17f241",
                        "custom_name": "Log",
                        "links": [],
                        "position": {
                            "x": 628,
                            "y": 107
                        },
                        "data": {
                            "label": "Log",
                            "name": "debug"
                        }
                    }
                ],
                "enabled": true,
                "status": "UNDEPLOYED",
                "last_updated": "2021-12-04T10:31:33.671Z",
                "message_count": 0
            }
        ],
        "enabled": true,
        "last_updated": "2021-12-04T10:32:13.736Z"
    },
    "organization_id": null,
    "enabled": true,
    "package_code": "angie.core",
    "package_version": "1.0.0"
}